const svg_element = require('svg-element')

const sheet = new CSSStyleSheet
sheet.replaceSync(get_theme())
/******************************************************************************
  WINDOW BAR COMPONENT
******************************************************************************/
// ----------------------------------------
// MODULE STATE & ID
var count = 0
const [cwd, dir] = [process.cwd(), __filename].map(x => new URL(x, 'file://').href)
const ID = dir.slice(cwd.length)
const STATE = { ids: {}, net: {} } // all state of component module
// ----------------------------------------
const default_opts = { }

module.exports = app_icon

function app_icon (opts = default_opts, protocol) {
  // ----------------------------------------
  // ID + JSON STATE
  // ----------------------------------------
  const id = count++
  // ----------------------------------------
  // OPTS
  // ----------------------------------------
  const { source, label } = opts
  // ----------------------------------------
  // PROTOCOL
  // ----------------------------------------
  // Communication data
  const PROTOCOLS = {}
  // ----------------------------------------
  // TEMPLATE
  // ----------------------------------------
  const el = document.createElement('div')
  const shopts = { mode: 'closed' }
  const shadow = el.attachShadow(shopts)
  shadow.adoptedStyleSheets = [sheet]
  shadow.innerHTML = `<div class="app-icon">
    <div class="svg-element"></div>
    <span>${label}</span>
  </div>`
  const svg_shadow = shadow.querySelector('.svg-element').attachShadow(shopts)
  // ----------------------------------------
  // ELEMENTS
  // ----------------------------------------
  const svg = svg_element({ source })
  svg_shadow.append(svg)
  // ----------------------------------------
  // INIT
  // ----------------------------------------

  return el
}
function get_theme () {
  return `
    .app-icon {
      display: flex;
      flex-direction: column;
      align-items: center;
      width: 100%;
    }
    span {
      background-color: var(--bg_color);
      width: 150px;
      padding: 10px 0;
      text-align: center;
      word-wrap: break-word;
    }
  `
}